<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Functionality Test</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .test { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
    .success { background: #d4edda; border-color: #c3e6cb; }
    .error { background: #f8d7da; border-color: #f5c6cb; }
    button { padding: 10px 20px; margin: 5px; }
    textarea { width: 100%; height: 100px; margin: 10px 0; }
  </style>
</head>
<body>
  <h1>功能测试页面</h1>
  
  <div class="test">
    <h3>测试1: 文本生成功能</h3>
    <textarea id="test-input" placeholder="输入测试文本...">Hello World</textarea>
    <button onclick="testGeneration()">测试生成</button>
    <div id="test-result"></div>
  </div>
  
  <div class="test">
    <h3>测试2: 复制功能</h3>
    <button onclick="testCopy()">测试复制</button>
    <div id="copy-result"></div>
  </div>
  
  <div class="test">
    <h3>测试3: 外部请求检查</h3>
    <button onclick="checkExternalRequests()">检查外部请求</button>
    <div id="external-result"></div>
  </div>
  
  <script>
    // 复制核心功能代码
    const italianPhrases = [
      "Mamma mia!", "Bellissimo!", "Che bella cosa!", "Fantastico!", 
      "Perfetto!", "Incredibile!", "Meraviglioso!"
    ];
    
    const italianEmojis = ["🍕", "🤌", "🇮🇹", "🍝", "☕", "🍷", "🎭"];
    
    function getRandomItem(array) {
      return array[Math.floor(Math.random() * array.length)];
    }
    
    function generateItalianText(text) {
      if (!text.trim()) return "";
      
      let result = text;
      
      if (Math.random() > 0.5) {
        result = getRandomItem(italianPhrases) + " " + result;
      }
      
      if (Math.random() > 0.5) {
        result = result + " " + getRandomItem(italianPhrases);
      }
      
      const numEmojis = Math.floor(Math.random() * 3) + 1;
      for (let i = 0; i < numEmojis; i++) {
        const emoji = getRandomItem(italianEmojis);
        const position = Math.floor(Math.random() * result.length);
        result = result.slice(0, position) + emoji + result.slice(position);
      }
      
      return result;
    }
    
    function testGeneration() {
      const input = document.getElementById('test-input').value;
      const result = generateItalianText(input);
      const resultDiv = document.getElementById('test-result');
      
      if (result) {
        resultDiv.innerHTML = `<div class="success">✅ 生成成功: "${result}"</div>`;
      } else {
        resultDiv.innerHTML = `<div class="error">❌ 生成失败</div>`;
      }
    }
    
    function testCopy() {
      const testText = "Test text for copying";
      navigator.clipboard.writeText(testText).then(function() {
        document.getElementById('copy-result').innerHTML = 
          '<div class="success">✅ 复制功能正常</div>';
      }).catch(function() {
        document.getElementById('copy-result').innerHTML = 
          '<div class="error">❌ 复制功能失败</div>';
      });
    }
    
    function checkExternalRequests() {
      const scripts = document.querySelectorAll('script[src]');
      const externalScripts = Array.from(scripts).filter(script => 
        !script.src.startsWith(window.location.origin)
      );
      
      const resultDiv = document.getElementById('external-result');
      
      if (externalScripts.length === 0) {
        resultDiv.innerHTML = '<div class="success">✅ 没有发现外部脚本请求</div>';
      } else {
        resultDiv.innerHTML = `<div class="error">❌ 发现 ${externalScripts.length} 个外部脚本</div>`;
        externalScripts.forEach(script => {
          resultDiv.innerHTML += `<div>${script.src}</div>`;
        });
      }
    }
    
    // 页面加载时自动运行一些测试
    window.onload = function() {
      checkExternalRequests();
    };
  </script>
</body>
</html> 